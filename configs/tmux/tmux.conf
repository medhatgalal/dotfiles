# Minimal tmux UX: main/watcher workflow

# Plugins
set -g @plugin 'tmux-plugins/tpm'
set -g @plugin 'tmux-plugins/tmux-sensible'

# Core behavior
set -g history-limit 200000
set -g mouse on
set -g default-terminal "screen-256color"
set -g pane-base-index 0
set -g base-index 1
set -g renumber-windows on
set -g set-clipboard on
set -g @pane_read_lines 3000
set -g @pane_read_preview_lines 3000

# Status line
set -g status on
set -g status-interval 5
set -g status-left-length 40
set -g status-right-length 140
set -g status-left '#[bold]#S #[default]| #I:#P'
set -g status-right ' ? help | y copy-last | Y preview-last | 1 main-watch | r reload | %Y-%m-%d %H:%M '

# Reload
bind-key r source-file ~/.tmux.conf \; display-message "tmux.conf reloaded"

# Porcelain helpers
bind-key ? display-popup -E '~/.local/bin/tmux-ux-help | less -R'
bind-key y run-shell '~/.local/bin/tmux-pane-read --last --lines "#{@pane_read_lines}" --copy >/dev/null 2>&1 && tmux display-message "Copied last pane" || tmux display-message "Capture failed"'
bind-key Y display-popup -E '~/.local/bin/tmux-pane-read --last --lines "#{@pane_read_preview_lines}" --stdout | less -R'

bind-key 1 run-shell '~/.local/bin/tmux-layout-apply main-watch && tmux display-message "Layout: main-watch"'
bind-key 2 run-shell '~/.local/bin/tmux-layout-apply pair && tmux display-message "Layout: pair"'
bind-key 3 run-shell '~/.local/bin/tmux-layout-apply tiled && tmux display-message "Layout: tiled"'

# Initialize TPM
run '~/.tmux/plugins/tpm/tpm'
